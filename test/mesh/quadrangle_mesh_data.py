import numpy as np

init_mesh_data = [
    {
        "node": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=np.float64),
        "edge": np.array([[0, 1], [1, 2], [2, 3], [3, 0]], dtype=np.int64),
        "cell": np.array([[0, 1, 2, 3]], dtype=np.int64),
        "NN": 4,
        "NE": 4,
        "NF": 4,
        "NC": 1,
        "face2cell": np.array([[0, 0, 0, 0],
                               [0, 0, 3, 3],
                               [0, 0, 1, 1],
                               [0, 0, 2, 2]], dtype=np.int64),
    }, ]
box_data = [
    {
        "box": [0, 1, 0, 1],
        "nx": 1,
        "ny": 1,
        "threshold": None,
        "node": np.array([[0., 0.],
                          [0., 1.],
                          [1., 0.],
                          [1., 1.]], dtype=np.float64),
        "edge": np.array([[1, 0],
                          [0, 2],
                          [3, 1],
                          [2, 3]], dtype=np.int64),
        "cell": np.array([[0, 2, 3, 1]], dtype=np.int64),
        "face2cell": np.array([[0, 0, 3, 3],
                               [0, 0, 0, 0],
                               [0, 0, 2, 2],
                               [0, 0, 1, 1]], dtype=np.int64),
    },
    {
        "box": [0, 1, 0, 1],
        "nx": 2,
        "ny": 2,
        "threshold": lambda p: (p[..., 0] < 0.5) & (p[..., 1] < 0.5),
        "node": np.array([[0., 0.5],
                          [0., 1.],
                          [0.5, 0.],
                          [0.5, 0.5],
                          [0.5, 1.],
                          [1., 0.],
                          [1., 0.5],
                          [1., 1.]], dtype=np.float64),
        "edge": np.array([[1, 0],
                          [0, 3],
                          [4, 1],
                          [3, 2],
                          [2, 5],
                          [3, 4],
                          [6, 3],
                          [7, 4],
                          [5, 6],
                          [6, 7]], dtype=np.int64),
        "cell": np.array([[0, 3, 4, 1],
                          [2, 5, 6, 3],
                          [3, 6, 7, 4]], dtype=np.int64),
        "face2cell": np.array([[0, 0, 3, 3],
                               [0, 0, 0, 0],
                               [0, 0, 2, 2],
                               [1, 1, 3, 3],
                               [1, 1, 0, 0],
                               [0, 2, 1, 3],
                               [1, 2, 2, 0],
                               [2, 2, 2, 2],
                               [1, 1, 1, 1],
                               [2, 2, 1, 1]], dtype=np.int64),
    }, ]
entity_data = [
    {
        "node": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=np.float64),
        "cell": np.array([[0, 1, 2, 3]], dtype=np.int64),
        "q": 2,
        "entity_measure": (np.array([0.0], dtype=np.float64),
                           np.array([1.0, 1.0, 1.0, 1.0], dtype=np.float64),
                           np.array([1.0], dtype=np.float64)),
        "edge_barycenter": np.array([[0.5, 0.],
                                     [0., 0.5],
                                     [1., 0.5],
                                     [0.5, 1.]], dtype=np.float64),
        "boundary_node_index": np.array([0, 1, 2, 3], dtype=np.int64),
        "boundary_edge_index": np.array([0, 1, 2, 3], dtype=np.int64),
        "boundary_cell_index": np.array([0], dtype=np.int64),
        "cell_barycenter": np.array([[0.5, 0.5]], dtype=np.float64),
        "bcs": (np.array([[0.78867513, 0.21132487], [0.21132487, 0.78867513]], dtype=np.float64),
                np.array([[0.78867513, 0.21132487], [0.21132487, 0.78867513]], dtype=np.float64)),
        "ws": np.array([0.25, 0.25, 0.25, 0.25], dtype=np.float64),
        "point": np.array([[[0.21132487, 0.21132487]],
                           [[0.21132487, 0.78867513]],
                           [[0.78867513, 0.21132487]],
                           [[0.78867513, 0.78867513]]], dtype=np.float64).transpose((1, 0, 2)),
    }, ]
geo_data = [
    {
        "node": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=np.float64),
        "cell": np.array([[0, 1, 2, 3]], dtype=np.int64),
        "edge_frame": (np.array([[0., -1.], [-1., 0.], [1., 0.], [0., 1.]], dtype=np.float64),
                       np.array([[1., 0.], [0., -1.], [0., 1.], [-1., 0.]], dtype=np.float64)),
        "edge_unit_normal": np.array([[0., -1.], [-1., 0.], [1., 0.], [0., 1.]], dtype=np.float64),
    }, ]
cal_data = [
    {
        "node": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=np.float64),
        "cell": np.array([[0, 1, 2, 3]], dtype=np.int64),
        "bcs": (np.array([[0.78867513, 0.21132487], [0.21132487, 0.78867513]], dtype=np.float64),
                np.array([[0.78867513, 0.21132487], [0.21132487, 0.78867513]], dtype=np.float64)),
        "shape_function": np.array([[0.62200847, 0.16666667, 0.16666667, 0.0446582],
                                    [0.16666667, 0.62200847, 0.0446582, 0.16666667],
                                    [0.16666667, 0.0446582, 0.62200847, 0.16666667],
                                    [0.0446582, 0.16666667, 0.16666667, 0.62200847]],
                                   dtype=np.float64),
        "grad_shape_function": np.array(
            [[[-0.78867513, -0.78867513], [-0.21132487, 0.78867513], [0.78867513, -0.21132487],
              [0.21132487, 0.21132487]],
             [[-0.21132487, -0.78867513], [-0.78867513, 0.78867513], [0.21132487, -0.21132487],
              [0.78867513, 0.21132487]],
             [[-0.78867513, -0.21132487], [-0.21132487, 0.21132487], [0.78867513, -0.78867513],
              [0.21132487, 0.78867513]],
             [[-0.21132487, -0.21132487], [-0.78867513, 0.21132487], [0.21132487, -0.78867513],
              [0.78867513, 0.78867513]]],
            dtype=np.float64),
        "grad_shape_function_x": np.array(
            [[[[-0.78867513, - 0.78867513], [-0.21132487, 0.78867513], [0.78867513, - 0.21132487],
               [0.21132487, 0.21132487]]],
             [[[-0.21132487, - 0.78867513], [-0.78867513, 0.78867513], [0.21132487, -0.21132487],
               [0.78867513, 0.21132487]]],
             [[[-0.78867513, - 0.21132487], [-0.21132487, 0.21132487], [0.78867513, - 0.78867513],
               [0.21132487, 0.78867513]]],
             [[[-0.21132487, - 0.21132487], [-0.78867513, 0.21132487], [0.21132487, - 0.78867513],
               [0.78867513, 0.78867513]]]],
            dtype=np.float64).transpose((1, 0, 2, 3)),
        "jacobi_matrix": np.array(
            [[[[1., 0.], [0., 1.]]],
             [[[1., 0.], [0., 1.]]],
             [[[1., 0.], [0., 1.]]],
             [[[1., 0.], [0., 1.]]]],
            dtype=np.float64),
        "first_fundamental_form": np.array(
            [[[[1., 0.], [0., 1.]]],
             [[[1., 0.], [0., 1.]]],
             [[[1., 0.], [0., 1.]]],
             [[[1., 0.], [0., 1.]]]],
            dtype=np.float64),
    }, ]
extend_data = [
    {
        "node": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=np.float64),
        "cell": np.array([[0, 1, 2, 3]], dtype=np.int64),
        "p": 2,
        "number_of_local_ipoints": 9,
        "number_of_global_ipoints": 9,
        "number_of_corner_nodes": 4,
        "interpolation_points": np.array([[0., 0.],
                                          [1., 0.],
                                          [1., 1.],
                                          [0., 1.],
                                          [0.5, 0.],
                                          [0., 0.5],
                                          [1., 0.5],
                                          [0.5, 1.],
                                          [0.5, 0.5]], dtype=np.float64),
        "p0": 1,
        "p1": 3,
        "prolongation_matrix": np.array([[1., 0., 0., 0.],
                                         [0., 1., 0., 0.],
                                         [0., 0., 1., 0.],
                                         [0., 0., 0., 1.],
                                         [0.66666667, 0.33333333, 0., 0.],
                                         [0.33333333, 0.66666667, 0., 0.],
                                         [0.33333333, 0., 0., 0.66666667],
                                         [0.66666667, 0., 0., 0.33333333],
                                         [0., 0.66666667, 0.33333333, 0.],
                                         [0., 0.33333333, 0.66666667, 0.],
                                         [0., 0., 0.66666667, 0.33333333],
                                         [0., 0., 0.33333333, 0.66666667],
                                         [0.44444444, 0.22222222, 0.11111111, 0.22222222],
                                         [0.22222222, 0.11111111, 0.22222222, 0.44444444],
                                         [0.22222222, 0.44444444, 0.22222222, 0.11111111],
                                         [0.11111111, 0.22222222, 0.44444444, 0.22222222]], dtype=np.float64),
        "cell_to_ipoint": np.array([[0, 5, 3, 4, 8, 7, 1, 6, 2]], dtype=np.int64),
        "jacobi_at_corner": np.array([[1., 1., 1., 1.]], dtype=np.float64),
        "angle": np.array([[1.57079633, 1.57079633, 1.57079633, 1.57079633]], dtype=np.float64),
        "cell_quality": np.array([1.], np.float64),
    }, ]
refine_data = [{
    "node": np.array([[0, 0], [1, 0], [1, 1], [0, 1]], dtype=np.float64),
    "cell": np.array([[0, 1, 2, 3]], dtype=np.int64),
    "n": 2,
    "refine_node": np.array([[0., 0.],
                             [1., 0.],
                             [1., 1.],
                             [0., 1.],
                             [0.5, 0.],
                             [0., 0.5],
                             [1., 0.5],
                             [0.5, 1.],
                             [0.5, 0.5],
                             [0.25, 0.],
                             [0., 0.25],
                             [0.75, 0.],
                             [1., 0.25],
                             [1., 0.75],
                             [0.75, 1.],
                             [0., 0.75],
                             [0.25, 1.],
                             [0.5, 0.25],
                             [0.25, 0.5],
                             [0.75, 0.5],
                             [0.5, 0.75],
                             [0.25, 0.25],
                             [0.75, 0.25],
                             [0.75, 0.75],
                             [0.25, 0.75]], dtype=np.float64),
    "refine_cell": np.array([[0, 9, 21, 10],
                             [9, 4, 17, 21],
                             [21, 17, 8, 18],
                             [10, 21, 18, 5],
                             [4, 11, 22, 17],
                             [11, 1, 12, 22],
                             [22, 12, 6, 19],
                             [17, 22, 19, 8],
                             [8, 19, 23, 20],
                             [19, 6, 13, 23],
                             [23, 13, 2, 14],
                             [20, 23, 14, 7],
                             [5, 18, 24, 15],
                             [18, 8, 20, 24],
                             [24, 20, 7, 16],
                             [15, 24, 16, 3]], dtype=np.int64),
    "refine_edge": np.array([[0, 9],
                             [10, 0],
                             [11, 1],
                             [1, 12],
                             [13, 2],
                             [2, 14],
                             [3, 15],
                             [16, 3],
                             [9, 4],
                             [4, 11],
                             [4, 17],
                             [5, 10],
                             [15, 5],
                             [18, 5],
                             [12, 6],
                             [6, 13],
                             [6, 19],
                             [14, 7],
                             [7, 16],
                             [7, 20],
                             [17, 8],
                             [8, 18],
                             [19, 8],
                             [20, 8],
                             [9, 21],
                             [21, 10],
                             [11, 22],
                             [12, 22],
                             [13, 23],
                             [14, 23],
                             [24, 15],
                             [16, 24],
                             [17, 21],
                             [22, 17],
                             [18, 21],
                             [18, 24],
                             [19, 22],
                             [19, 23],
                             [23, 20],
                             [20, 24]], dtype=np.int64),
    "refine_face_to_cell": np.array([[0, 0, 0, 0],
                                     [0, 0, 3, 3],
                                     [5, 5, 0, 0],
                                     [5, 5, 1, 1],
                                     [10, 10, 1, 1],
                                     [10, 10, 2, 2],
                                     [15, 15, 3, 3],
                                     [15, 15, 2, 2],
                                     [1, 1, 0, 0],
                                     [4, 4, 0, 0],
                                     [1, 4, 1, 3],
                                     [3, 3, 3, 3],
                                     [12, 12, 3, 3],
                                     [3, 12, 2, 0],
                                     [6, 6, 1, 1],
                                     [9, 9, 1, 1],
                                     [6, 9, 2, 0],
                                     [11, 11, 2, 2],
                                     [14, 14, 2, 2],
                                     [11, 14, 3, 1],
                                     [2, 7, 1, 3],
                                     [2, 13, 2, 0],
                                     [7, 8, 2, 0],
                                     [8, 13, 3, 1],
                                     [0, 1, 1, 3],
                                     [0, 3, 2, 0],
                                     [4, 5, 1, 3],
                                     [5, 6, 2, 0],
                                     [9, 10, 2, 0],
                                     [10, 11, 3, 1],
                                     [12, 15, 2, 0],
                                     [14, 15, 3, 1],
                                     [1, 2, 2, 0],
                                     [4, 7, 2, 0],
                                     [2, 3, 3, 1],
                                     [12, 13, 1, 3],
                                     [6, 7, 3, 1],
                                     [8, 9, 1, 3],
                                     [8, 11, 2, 0],
                                     [13, 14, 2, 0]], dtype=np.int64),
}, ]
mesh_from_polygon_gmsh_data = [{
    "vertices": [(0.0, 0.0), (2.0, 0.0), (2.0, 1.0), (1.0, 1.0), (1.0, 2.0), (0.0, 2.0)],
    "h": 1,
    "node": np.array([[0., 0.],
                      [2., 0.],
                      [2., 1.],
                      [1., 1.],
                      [1., 2.],
                      [0., 2.],
                      [1., 0.],
                      [2., 0.5],
                      [1.5, 1.],
                      [1., 1.5],
                      [0.5, 2.],
                      [0., 1.],
                      [1.5546875, 0.5546875],
                      [0.5546875, 1.5546875]], dtype=np.float64),
    "edge": np.array([[0, 6],
                      [11, 0],
                      [6, 1],
                      [1, 7],
                      [7, 2],
                      [2, 8],
                      [6, 3],
                      [8, 3],
                      [3, 9],
                      [3, 11],
                      [9, 4],
                      [4, 10],
                      [10, 5],
                      [5, 11],
                      [12, 6],
                      [7, 12],
                      [12, 8],
                      [9, 13],
                      [13, 10],
                      [11, 13]], dtype=np.int64),
    "cell": np.array([[11, 0, 6, 3],
                      [11, 13, 10, 5],
                      [11, 3, 9, 13],
                      [6, 1, 7, 12],
                      [6, 12, 8, 3],
                      [4, 10, 13, 9],
                      [7, 2, 8, 12]], dtype=np.int64),
    "face2cell": np.array([[0, 0, 1, 1],
                           [0, 0, 0, 0],
                           [3, 3, 0, 0],
                           [3, 3, 1, 1],
                           [6, 6, 0, 0],
                           [6, 6, 1, 1],
                           [0, 4, 2, 3],
                           [4, 4, 2, 2],
                           [2, 2, 1, 1],
                           [0, 2, 3, 0],
                           [5, 5, 3, 3],
                           [5, 5, 0, 0],
                           [1, 1, 2, 2],
                           [1, 1, 3, 3],
                           [3, 4, 3, 0],
                           [3, 6, 2, 3],
                           [4, 6, 1, 2],
                           [2, 5, 2, 2],
                           [1, 5, 1, 1],
                           [1, 2, 0, 3]], dtype=np.int64),
}, ]
mesh_from_triangle_data = [{
    "tri_node": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]], dtype=np.float64),
    "tri_cell": np.array([[0, 1, 2]], dtype=np.int64),
    "node": np.array([[0., 0.],
                      [1., 0.],
                      [0., 1.],
                      [0.5, 0.],
                      [0., 0.5],
                      [0.5, 0.5],
                      [0.33333333, 0.33333333]], dtype=np.float64),
    "edge": np.array([[0, 3],
                      [4, 0],
                      [3, 1],
                      [1, 5],
                      [2, 4],
                      [5, 2],
                      [3, 6],
                      [4, 6],
                      [6, 5]], dtype=np.int64),
    "cell": np.array([[6, 5, 2, 4],
                      [6, 4, 0, 3],
                      [6, 3, 1, 5]], dtype=np.int64),
    "face2cell": np.array([[1, 1, 2, 2],
                           [1, 1, 1, 1],
                           [2, 2, 1, 1],
                           [2, 2, 2, 2],
                           [0, 0, 2, 2],
                           [0, 0, 1, 1],
                           [1, 2, 3, 0],
                           [0, 1, 3, 0],
                           [0, 2, 0, 3]], dtype=np.int64),
},]

mesh_from_sub_domain_data = [{
"domain_node": np.array([[0., 0.], [1., 0.], [1., 1.], [0., 1.]]),
"domain_edge":  np.array([[0, 1], [1, 2], [2, 3], [3, 0]]),
"domain_half_edge": np.array([
    [1, 0, 2, 6, 1],
    [0, -1, 7, 3, 0],
    [2, 0, 4, 0, 3],
    [1, -1, 1, 5, 2],
    [3, 0, 6, 2, 5],
    [2, -1, 3, 7, 4],
    [0, 0, 0, 4, 7],
    [3, -1, 5, 1, 6]
]),
"domain_line": [
    np.array([[0., 0.], [0.33, 0.], [0.67, 0.], [1., 0.]]),
    np.array([[1, 0], [1, 0.5], [1, 1]]),
    np.array([[1, 1], [0.67, 1], [0.33, 1], [0, 1]]),
    np.array([[0, 1], [0, 0.5], [0, 0]])
],
"node_to_out_edge": [
    [0, 7],
    [2, 1],
    [4, 3],
    [6, 5]
],
    "domain_boundary": np.array([0, 1, 2, 3]),
}]

interpolation_matrix_data = [
        "node": np.array([[0. 0.],[1. 0.],[1. 1.],[0. 1.]], dtype=np.float64),
        "edge": np.array([[0, 1], [3, 0], [1, 2], [2, 3]], dtype=np.int32), 
        "cell": np.array([[0, 1, 2, 3]], dtype=np.int32),
        {
            "n":1
            "func":node[:,0]+2*node[:,1]+3
            "IM":
            <Compressed Sparse Row sparse matrix of dtype 'float64' with 16 stored elements and shape (9, 4)>
                Coords        Values
                (0, 0)        1.0
                (1, 1)        1.0
                (2, 2)        1.0
                (3, 3)        1.0
                (4, 0)        0.5
                (4, 1)        0.5
                (5, 3)        0.5
                (5, 0)        0.5
                (6, 1)        0.5
                (6, 2)        0.5
                (7, 2)        0.5
                (7, 3)        0.5
                (8, 0)        0.25
                (8, 1)        0.25
                (8, 2)        0.25
                (8, 3)        0.25 

            "excat_value":
           [[3.  4.  6.  5.  3.5 4.  5.  5.5 4.5],
            dtype = np.float64]
            "test_value":
            [[3.  4.  6.  5.  3.5 4.  5.  5.5 4.5],
            dtype = np.float64]
            "is_excat_close_test":True
        }
        {
            "n":3
            "func":2*node[:,0]+2*node[:,1]+2
            "IM":
            <Compressed Sparse Row sparse matrix of dtype 'float64' with 16 stored elements and shape (9, 4)>
                Coords        Values
                (0, 0)        1.0
                (1, 1)        1.0
                (2, 2)        1.0
                (3, 3)        1.0
                (4, 0)        0.5
                (4, 1)        0.5
                (5, 3)        0.5
                (5, 0)        0.5
                (6, 1)        0.5
                (6, 2)        0.5
                (7, 2)        0.5
                (7, 3)        0.5
                (8, 0)        0.25
                (8, 1)        0.25
                (8, 2)        0.25
                (8, 3)        0.25 
            <Compressed Sparse Row sparse matrix of dtype 'float64' with 49 stored elements and shape (25, 9)>
                Coords        Values
                (0, 0)        1.0
                (1, 1)        1.0
                (2, 2)        1.0
                (3, 3)        1.0
                (4, 4)        1.0
                (5, 5)        1.0
                (6, 6)        1.0
                (7, 7)        1.0
                (8, 8)        1.0
                (9, 0)        0.5
                (9, 4)        0.5
                (10, 5)       0.5
                (10, 0)       0.5
                (11, 4)       0.5
                (11, 1)       0.5
                (12, 1)       0.5
                (12, 6)       0.5
                (13, 6)       0.5
                (13, 2)       0.5
                (14, 2)       0.5
                (14, 7)       0.5
                (15, 3)       0.5
                (15, 5)       0.5
                (16, 7)       0.5
                (16, 3)       0.5
                (17, 4)       0.5
                (17, 8)       0.5
                (18, 8)       0.5
                (18, 5)       0.5
                (19, 6)       0.5
                (19, 8)       0.5
                (20, 7)       0.5
                (20, 8)       0.5
                (21, 0)       0.25
                (21, 4)       0.25
                (21, 8)       0.25
                (21, 5)       0.25
                (22, 4)       0.25
                (22, 1)       0.25
                (22, 6)       0.25
                (22, 8)       0.25
                (23, 8)       0.25
                (23, 6)       0.25
                (23, 2)       0.25
                (23, 7)       0.25
                (24, 5)       0.25
                (24, 8)       0.25
                (24, 7)       0.25
                (24, 3)       0.25
            "excat_value":
           [[2.  4.  6.  4.  3.  3.  5.  5.  4.  2.5 2.5 3.5 4.5 5.5 5.5 3.5 4.5 3.5
            3.5 4.5 4.5 3.  4.  5.  4. ],
            dtype = np.float64]
            "test_value":
            [[2.  4.  6.  4.  3.  3.  5.  5.  4.  2.5 2.5 3.5 4.5 5.5 5.5 3.5 4.5 3.5
            3.5 4.5 4.5 3.  4.  5.  4. ],
            dtype = np.float64]
            "is_excat_close_test":True
        }

        ]